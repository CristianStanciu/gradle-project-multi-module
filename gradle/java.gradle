apply plugin: 'java'
apply plugin: "jacoco"

sourceCompatibility = 17
targetCompatibility = 17

jar.enabled = true

compileJava.options.encoding = 'UTF-8'
compileTestJava.options.encoding = 'UTF-8'

dependencies {
//    testCompile 'junit:junit-jupiter:5.11.0'
    testCompile 'junit:junit:4.9.1'
}

test {
    workingDir buildDir

    jacoco {
        append = false
        //destinationFile = file("$buildDir/jacoco/test.exec")
        excludes = ['**/test/**']
    }

}

jacoco {
    toolVersion = '0.8.7'
}

jacocoTestReport {
    reports {
        xml.enabled true
        csv.enabled false
        //xml.destination = file("$buildDir/reports/jacoco/jacocoTestReport.xml")
        html.destination file("$buildDir/reports/jacoco")
    }
    afterEvaluate {
        classDirectories = files(classDirectories.files.collect {
            fileTree(dir: it, exclude: '**/test/**')
        })

        sourceDirectories = files(sourceDirectories.files.collect {
            fileTree(dir: it, exclude: '**/test/**')
        })
    }
}

